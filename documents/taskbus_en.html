<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>taskbus_en.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}@import url(http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700);.haroopad{padding:20px;color:#222;font-size:15px;font-family:"Roboto Condensed",Tauri,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.haroopad a{color:#3269a0}.haroopad a:hover{color:#4183c4}.haroopad h2{border-bottom:1px solid #e6e6e6}.haroopad h6{color:#777}.haroopad hr{border:1px solid #e6e6e6}.haroopad blockquote>code,.haroopad h1>code,.haroopad h2>code,.haroopad h3>code,.haroopad h4>code,.haroopad h5>code,.haroopad h6>code,.haroopad li>code,.haroopad p>code,.haroopad td>code{font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;background-color:rgba(0,0,0,.02);padding:.2em .5em;border:1px solid #efefef}.haroopad pre>code{font-size:1em;letter-spacing:-1px;font-weight:700}.haroopad blockquote{border-left:4px solid #e6e6e6;padding:0 15px;color:#777}.haroopad table{background-color:#fafafa}.haroopad table tr td,.haroopad table tr th{border:1px solid #e6e6e6}.haroopad table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#fdf6e3;color:#657b83;-webkit-text-size-adjust:none}.diff .hljs-header,.hljs-comment,.hljs-doctype,.hljs-javadoc,.hljs-pi,.lisp .hljs-string{color:#93a1a1}.css .hljs-tag,.hljs-addition,.hljs-keyword,.hljs-request,.hljs-status,.hljs-winutils,.method,.nginx .hljs-title{color:#859900}.hljs-command,.hljs-dartdoc,.hljs-hexcolor,.hljs-link_url,.hljs-number,.hljs-phpdoc,.hljs-regexp,.hljs-rules .hljs-value,.hljs-string,.hljs-tag .hljs-value,.tex .hljs-formula{color:#2aa198}.css .hljs-function,.hljs-built_in,.hljs-chunk,.hljs-decorator,.hljs-id,.hljs-identifier,.hljs-localvars,.hljs-title,.vhdl .hljs-literal{color:#268bd2}.hljs-attribute,.hljs-class .hljs-title,.hljs-constant,.hljs-link_reference,.hljs-parent,.hljs-type,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number{color:#b58900}.css .hljs-pseudo,.diff .hljs-change,.hljs-attr_selector,.hljs-cdata,.hljs-header,.hljs-pragma,.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-shebang,.hljs-special,.hljs-subst,.hljs-symbol,.hljs-symbol .hljs-string{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#eee8d5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:2px;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:2px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:1em}.MathJax_MenuRadioCheck.RTL{right:1em;left:auto}.MathJax_MenuLabel{padding:2px 2em 4px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #CCC;margin:4px 1px 0}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:Highlight;color:HighlightText}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown haroopad">
<h1 id="taskbus---a-cross-platform-multi-process-cooperation-framework"><a name="taskbus---a-cross-platform-multi-process-cooperation-framework" href="#taskbus---a-cross-platform-multi-process-cooperation-framework"></a>Taskbus - A cross platform multi-process cooperation framework</h1><p><img src="file:///U:/taskBus/taskBus/taskbusplatform/images/taskBus.png" alt="TaskBusLogo"></p><p class="toc" style="undefined"></p><ul>
<li><ul>
<li><span class="title">
<a href="#1.-what-is-taskbus" title="1. What is TaskBus">1. What is TaskBus</a>
</span>
<!--span class="number">
0
</span-->
</li>
<li><span class="title">
<a href="#2.-key-features" title="2. Key Features">2. Key Features</a>
</span>
<!--span class="number">
1
</span-->
</li>
<li><span class="title">
<a href="#3.-basic-principle" title="3. Basic Principle">3. Basic Principle</a>
</span>
<!--span class="number">
2
</span-->
<ul>
<li><span class="title">
<a href="#3.1-input-and-output" title="3.1 Input and Output">3.1 Input and Output</a>
</span>
<!--span class="number">
3
</span-->
</li>
<li><span class="title">
<a href="#3.2-subjects-and-paths" title="3.2 Subjects and Paths">3.2 Subjects and Paths</a>
</span>
<!--span class="number">
4
</span-->
<ul>
<li><span class="title">
<a href="#3.2.1-subjects" title="3.2.1 Subjects">3.2.1 Subjects</a>
</span>
<!--span class="number">
5
</span-->
</li>
<li><span class="title">
<a href="#3.2.2-paths" title="3.2.2 Paths">3.2.2 Paths</a>
</span>
<!--span class="number">
6
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#3.3-io-with-subjects-and-paths" title="3.3 IO with Subjects and Paths">3.3 IO with Subjects and Paths</a>
</span>
<!--span class="number">
7
</span-->
</li>
<li><span class="title">
<a href="#3.4-function-publish" title="3.4 Function publish">3.4 Function publish</a>
</span>
<!--span class="number">
8
</span-->
</li>
<li><span class="title">
<a href="#3.5-command-line-arguments" title="3.5 Command-line arguments">3.5 Command-line arguments</a>
</span>
<!--span class="number">
9
</span-->
</li>
<li><span class="title">
<a href="#3.6-first-hello-world-module" title="3.6 First Hello-world module">3.6 First Hello-world module</a>
</span>
<!--span class="number">
10
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#4.-development-guide" title="4. Development Guide">4. Development Guide</a>
</span>
<!--span class="number">
11
</span-->
<ul>
<li><span class="title">
<a href="#4.1-design-functions-and-writing-json-file" title="4.1 Design functions and writing JSON file">4.1 Design functions and writing JSON file</a>
</span>
<!--span class="number">
12
</span-->
</li>
<li><span class="title">
<a href="#4.2-accelerate-development-progress-with-toolcodes" title="4.2 Accelerate development progress with toolcodes">4.2 Accelerate development progress with toolcodes</a>
</span>
<!--span class="number">
13
</span-->
<ul>
<li><span class="title">
<a href="#4.2.1-command-line-interpretation" title="4.2.1 Command Line Interpretation">4.2.1 Command Line Interpretation</a>
</span>
<!--span class="number">
14
</span-->
</li>
<li><span class="title">
<a href="#4.2.2-data-sending-and-receiving" title="4.2.2 Data sending and receiving">4.2.2 Data sending and receiving</a>
</span>
<!--span class="number">
15
</span-->
</li>
<li><span class="title">
<a href="#4.2.3-debugging" title="4.2.3 Debugging">4.2.3 Debugging</a>
</span>
<!--span class="number">
16
</span-->
<ul>
<li><span class="title">
<a href="#(1)turn-on-debug-and-recording-data" title="(1)Turn on debug and recording data">(1)Turn on debug and recording data</a>
</span>
<!--span class="number">
17
</span-->
</li>
<li><span class="title">
<a href="#(2)playback-and-debugging" title="(2)Playback and debugging">(2)Playback and debugging</a>
</span>
<!--span class="number">
18
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#4.3-data-processing" title="4.3 Data Processing">4.3 Data Processing</a>
</span>
<!--span class="number">
19
</span-->
<ul>
<li><span class="title">
<a href="#4.3.1-data-caching-recommendations" title="4.3.1 Data Caching recommendations">4.3.1 Data Caching recommendations</a>
</span>
<!--span class="number">
20
</span-->
</li>
<li><span class="title">
<a href="#4.3.2-load-control" title="4.3.2 Load control">4.3.2 Load control</a>
</span>
<!--span class="number">
21
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#4.4-runtime-and-deploy" title="4.4 Runtime and deploy">4.4 Runtime and deploy</a>
</span>
<!--span class="number">
22
</span-->
<ul>
<li><span class="title">
<a href="#4.4.1-path-policy" title="4.4.1 Path Policy">4.4.1 Path Policy</a>
</span>
<!--span class="number">
23
</span-->
</li>
<li><span class="title">
<a href="#4.4.2-sub-projects-and-nesting" title="4.4.2 Sub-Projects and nesting">4.4.2 Sub-Projects and nesting</a>
</span>
<!--span class="number">
24
</span-->
<ul>
<li><span class="title">
<a href="#(1)-create-a-sub-project" title="(1) Create a sub project">(1) Create a sub project</a>
</span>
<!--span class="number">
25
</span-->
</li>
<li><span class="title">
<a href="#(2)-attach-a-wrapper-file" title="(2) Attach a wrapper file">(2) Attach a wrapper file</a>
</span>
<!--span class="number">
26
</span-->
</li>
<li><span class="title">
<a href="#(3)-attach-default-module-load-script" title="(3) Attach default module load script">(3) Attach default module load script</a>
</span>
<!--span class="number">
27
</span-->
</li>
<li><span class="title">
<a href="#(4)-load-subproject-into-taskbusplatform" title="(4) Load Subproject into taskBusPlatform">(4) Load Subproject into taskBusPlatform</a>
</span>
<!--span class="number">
28
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#4.5-multi-platform,-distributed-and-scalable" title="4.5 Multi-platform, distributed and scalable">4.5 Multi-platform, distributed and scalable</a>
</span>
<!--span class="number">
29
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#5-about-taskbus" title="5 About Taskbus">5 About Taskbus</a>
</span>
<!--span class="number">
30
</span-->
</li>
</ul>
</li>

</ul>
<p></p><h2 id="1.-what-is-taskbus"><a name="1.-what-is-taskbus" href="#1.-what-is-taskbus"></a>1. What is TaskBus</h2><p>Taskbus is a cross-platform multi-process cooperation framework for non-professional developers, with four features of <strong>process based, language independent, compiler independent, and architecture Independent</strong>.</p><p>The <strong>non-professional developer </strong>is a general concept that can be understood as a developer without specialized software engineering training. For example, the university’s research team, which needs to develop its own small tools for algorithm validation, and to conduct data analysis in a field (chemical, mechanical, communications, electronics, etc.), requires a long-term team of engineers working on non-consumer tool software development.</p><p>Taskbus provides a modular drag-and-drop interface like Simulink or gnu-radio that can be used to implement (quasi-)real-time processing logic on a general-purpose computer. However, structurally, it is completely different from the two. It provides a process management platform by defining a feature release and data exchange standard to combine processes developed in different languages. In the example, you can see modules generated by tool chains such as Python2/3,nodejs,c#,gnuoctave, Qt, C + +, MFC, and so on. The platform put them together and do things well.</p><p><img src="images/main_ui_en.png" alt="taskBus UI"></p><h2 id="2.-key-features"><a name="2.-key-features" href="#2.-key-features"></a>2. Key Features</h2><p>The core idea of Taskbus is “Define IO Standard instead of toolchain to be used, define connection structure instead of architecture or algorithm. ”</p><ol>
<li>Taskbus only defines the method and format of data exchange, and does not require the implementation of language and operation environment. This brings a very high level of flexibility.</li><li>Taskbus defines only the logical connection structure between processes and does not define the architecture and methods required for specific features built by the user.</li></ol><p>Key Features： </p><ul>
<li><strong>Simple</strong>: The process accepts initialization parameters via command-line parameters. Working data io is directly based on standard input-output (STDIN,STDOUT,STDERR). There is no knowledge requirement for databases, COM, CORBA, dynamic links, soap, or network protocols. Based on the debugging function provided by the platform, the logic of each module can be debugged independently from the platform after recording and playback.</li><li><strong>Flexible</strong>: Through the concept of ‘<em>Subject and Path</em>‘, multiple logical data can share a pair of pipelines at the same time . The relationship between them is entirely determined by the module designer. Based on the functions provided by the network module and the database module, the distributed processing system can be built on different operating systems. You can even wrap the MATLAB, Octave, and Python programs in a wrapper.</li><li><strong>Stability</strong>: Errors are controlled within a module process and are easy to spot problems. Independent priority (NICE) can be set for each module.</li><li><strong>High Efficiency</strong>: Multi-process parallel, distributed computing and priority control, so that the general-purpose PC computing environment can also achieve real-time processing/quasi-real-time processing capabilities. When your module joins features such as GPU acceleration, you can significantly improve the performance of your entire system.</li><li><strong>Push instead of request</strong>: Unlike Gnu-radio, Taskbus front module pushes data to back module proactively. The data flow control is implemented by the module in a simple way(Refer to the “Load Control” section below).</li></ul><p><img src="images/features_en.png" alt="taskBus UI"></p><h2 id="3.-basic-principle"><a name="3.-basic-principle" href="#3.-basic-principle"></a>3. Basic Principle</h2><p>Many of the classic programming language cookbooks are  started from the console. The console program receives user input through the keyboard and prints the result of the operation to the screen. In fact, the process starts with three special file handles available, whether in Linux or Windows. They are standard output (stdout), standard input (stdin), standard error (STDERR). </p><p>Most modern languages support the creation of child processes, and can take over  child processes’ standard pipelines through “pipeline redirection” technology. Taskbus technology, which is based on this feature, reads data from the stdout of each child process and forwards it to the required subprocess (stdin).</p><h3 id="3.1-input-and-output"><a name="3.1-input-and-output" href="#3.1-input-and-output"></a>3.1 Input and Output</h3><p>A textbook C program that implements XOR operations is generally similar to this:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>#include &amp;lt;stdio.h&amp;gt;
int main(int argc, char *argv[])
{
    unsigned int a[4];
    scanf(&quot;%u,%u,%u,%u&quot;,a,a+1,a+2,a+3);
    for(int i = 0; i &amp;lt; 4; ++i)
        a[i] = 0xFFFFFFFF ^ a[i];
    printf(&quot;%u,%u,%u,%u\n&quot;,a[0],a[1],a[2],a[3]);
    return 0;
}
</code></pre>"><span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;stdio.h&gt;</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span>
</span>{
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a[<span class="hljs-number">4</span>];
    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%u,%u,%u,%u"</span>,a,a+<span class="hljs-number">1</span>,a+<span class="hljs-number">2</span>,a+<span class="hljs-number">3</span>);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; ++i)
        a[i] = <span class="hljs-number">0xFFFFFFFF</span> ^ a[i];
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%u,%u,%u,%u\n"</span>,a[<span class="hljs-number">0</span>],a[<span class="hljs-number">1</span>],a[<span class="hljs-number">2</span>],a[<span class="hljs-number">3</span>]);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre><p>The program above input four numbers from the keyboard, take the inverse, output them to screen. Because the keyboard is associated with the stdin, the screen is associated with the stdout, which is essentially equivalent to the following program:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>    fscanf(stdin,&quot;%u,%u,%u,%u&quot;,a,a+1,a+2,a+3);
    fprintf(stdout,&quot;%u,%u,%u,%u\n&quot;,a[0],a[1],a[2],a[3]);
</code></pre>">    <span class="hljs-built_in">fscanf</span>(stdin,<span class="hljs-string">"%u,%u,%u,%u"</span>,a,a+<span class="hljs-number">1</span>,a+<span class="hljs-number">2</span>,a+<span class="hljs-number">3</span>);
    <span class="hljs-built_in">fprintf</span>(stdout,<span class="hljs-string">"%u,%u,%u,%u\n"</span>,a[<span class="hljs-number">0</span>],a[<span class="hljs-number">1</span>],a[<span class="hljs-number">2</span>],a[<span class="hljs-number">3</span>]);
</code></pre><p>The input and output of the Taskbus module is very similar to the above program. There is only one difference, that binary read and write functions is used instead of text edition:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>    unsigned int a[4];
    fread(a,sizeof(int),4,stdin);
    for(int i = 0; i &amp;lt; 4; ++i)
        a[i] = 0xFFFFFFFF ^ a[i];
    fwrite(a,sizeof(int),4,stdout);
</code></pre>">    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a[<span class="hljs-number">4</span>];
    fread(a,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">4</span>,stdin);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; ++i)
        a[i] = <span class="hljs-number">0xFFFFFFFF</span> ^ a[i];
    fwrite(a,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">4</span>,stdout);
</code></pre><h3 id="3.2-subjects-and-paths"><a name="3.2-subjects-and-paths" href="#3.2-subjects-and-paths"></a>3.2 Subjects and Paths</h3><p>A child process has only one pair of input and output pipelines. By introducing the concept of <em>Subjects and Paths</em>, multiple content can be transmited through one channel .</p><h4 id="3.2.1-subjects"><a name="3.2.1-subjects" href="#3.2.1-subjects"></a>3.2.1 Subjects</h4><p><em>Subject</em> indicates a class of data. such as the waveform collected by the sound card, and the stream of bytes read from the file.</p><p>On the graphical interface, the Subjects is shown as a pin. Each Subjects has a memorable name; at run time, the Taskbus platform sets an integer ID for each Subject based on the connection relationship. The input and output pins with the same ID will be connected.</p><p><img src="images/Subjects.png" alt="taskBus UI"></p><p>A Subject producer generates data and gives it to the platform. The platform gives the data to all consumers connected to the Subjects.<br><strong>NOTE:</strong> Different pins can produce the same Subject ID, and can also listen to a same ID. For the Producers, the act of doing so is consistent. For consumers, how to deal with the same subject ID, depending on the module implementation.</p><h4 id="3.2.2-paths"><a name="3.2.2-paths" href="#3.2.2-paths"></a>3.2.2 Paths</h4><p>Path distinguishes an independent natural sequence in a class of topics. In the example below, the data collected by the two sound cards are remitted into the same FFT converter. For converters, it is necessary to distinguish between two natural timing sequences in order not to cause confusion.</p><p><img src="images/Paths.png" alt="Paths UI"></p><p>The sound card module in the image above uses its own process ID (2, 6) as the path number, which makes it very convenient to calibrate the source of the data.</p><h3 id="3.3-io-with-subjects-and-paths"><a name="3.3-io-with-subjects-and-paths" href="#3.3-io-with-subjects-and-paths"></a>3.3 IO with Subjects and Paths</h3><p>Given the above, we can implement stdio-based communication with a slight modification in the preceding code.</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>void record( char a[], int data_len, int path_id)
{
    int out_subject_id, out_path_id;
    int out_data_len;
    char b[MAX_LEN];
    deal(a, datalen,path_id,
         &amp;amp;out_subject_id,
         &amp;amp;out_path_id,
         &amp;amp;out_data_len,
         b
         );
    fwrite (&amp;amp;out_subject_id,sizeof(int),1,stdin);
    fwrite (&amp;amp;out_path_id,sizeof(int),1,stdin);
    fwrite (&amp;amp;out_data_len,sizeof(int),1,stdin);
    fwrite (b,sizeof(char),out_data_len,stdin);
}
int main(int argc, char *argv[])
{
    int subject_id, path_id;
    int data_len;
    char a[MAX_LEN];
    while (!finished())
    {
        fread (&amp;amp;subject_id,sizeof(int),1,stdin);
        fread (&amp;amp;path_id,sizeof(int),1,stdin);
        fread (&amp;amp;data_len,sizeof(int),1,stdin);
        fread (a,sizeof(char),data_len,stdin);
        switch (subject_id)
        {
        case ID_WAV:
            record(a,data_len,path_id);
            break;
        case ID_DAT:
            deal(a,data_len,path_id);
            break;
        default:
            break;
        }
    }
    return 0;
}
</code></pre>"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">record</span><span class="hljs-params">( <span class="hljs-keyword">char</span> a[], <span class="hljs-keyword">int</span> data_len, <span class="hljs-keyword">int</span> path_id)</span>
</span>{
    <span class="hljs-keyword">int</span> out_subject_id, out_path_id;
    <span class="hljs-keyword">int</span> out_data_len;
    <span class="hljs-keyword">char</span> b[MAX_LEN];
    deal(a, datalen,path_id,
         &amp;out_subject_id,
         &amp;out_path_id,
         &amp;out_data_len,
         b
         );
    fwrite (&amp;out_subject_id,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
    fwrite (&amp;out_path_id,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
    fwrite (&amp;out_data_len,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
    fwrite (b,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">char</span>),out_data_len,stdin);
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> *argv[])</span>
</span>{
    <span class="hljs-keyword">int</span> subject_id, path_id;
    <span class="hljs-keyword">int</span> data_len;
    <span class="hljs-keyword">char</span> a[MAX_LEN];
    <span class="hljs-keyword">while</span> (!finished())
    {
        fread (&amp;subject_id,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
        fread (&amp;path_id,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
        fread (&amp;data_len,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
        fread (a,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">char</span>),data_len,stdin);
        <span class="hljs-keyword">switch</span> (subject_id)
        {
        <span class="hljs-keyword">case</span> ID_WAV:
            record(a,data_len,path_id);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ID_DAT:
            deal(a,data_len,path_id);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">break</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre><p>The above code lacks context, but clearly illustrates the most basic communication principle of taskbus. Between the different modules, it is through this method of communication.</p><h3 id="3.4-function-publish"><a name="3.4-function-publish" href="#3.4-function-publish"></a>3.4 Function publish</h3><p>taskBus modules are developed independently by the developer. A JSON file is required to publish its own functionality to platform. In this way, the platform knows the types of topics supported by the module, parameter options.<br>A typical function description file must consist of three parts, namely:</p><ol>
<li>Parameter table</li><li>Input Subjects Sheet</li><li>Output Subjects Sheet<br>Other user-defined sections can still be read and displayed on the platform, but with no practical meaning. The HelloWorld example provided by the platform contains two functions, one is bit or the other is sequential inversion. The structure of the JSON file is as follows:</li></ol><pre class="json hljs"><code class="json" data-origin="<pre><code class=&quot;json&quot;>{
    &quot;example_bitxor&quot;:{
        &quot;name&quot;:&quot;bitxor&quot;,
        &quot;parameters&quot;:{
             &quot;mask&quot;:{
                &quot;type&quot;:&quot;unsigned char&quot;,
                &quot;tooltip&quot;:&quot;bytemask&quot;,
                &quot;default&quot;:255,
                &quot;range&quot;:{
                    &quot;min&quot;:0,
                    &quot;max&quot;:255
                }
            }
        },
        &quot;input_subjects&quot;:
        {
            &quot;data_in&quot;:{
                &quot;type&quot;:&quot;byte&quot;,
                &quot;tooltip&quot;:&quot;input&quot;
            }
        },
        &quot;output_subjects&quot;:{
            &quot;data_out&quot;:{
                &quot;type&quot;:&quot;byte&quot;,
                &quot;tooltip&quot;:&quot;output&quot;
            }
        },
        &quot;info&quot;:{
            &quot;auther&quot;:&quot;kelly&quot;,
            &quot;version&quot;:[1,0,0],
            &quot;mail&quot;:&quot;kelly@163.com&quot;
        }
    },
    &quot;example_reverse&quot;:{
        &quot;name&quot;:&quot;reverse&quot;,
        &quot;parameters&quot;:{
         },
        &quot;input_subjects&quot;:
        {
            &quot;data_in&quot;:{
                &quot;type&quot;:&quot;byte&quot;,
                &quot;tooltip&quot;:&quot;input&quot;
            }
        },
        &quot;output_subjects&quot;:{
            &quot;data_out&quot;:{
                &quot;type&quot;:&quot;byte&quot;,
                &quot;tooltip&quot;:&quot;output&quot;
            }
        },
        &quot;info&quot;:{
            &quot;auther&quot;:&quot;kelly&quot;,
            &quot;version&quot;:[1,1,0],
            &quot;mail&quot;:&quot;kelly@163.com&quot;
        }
    }
}
</code></pre>">{
    "<span class="hljs-attribute">example_bitxor</span>":<span class="hljs-value">{
        "<span class="hljs-attribute">name</span>":<span class="hljs-value"><span class="hljs-string">"bitxor"</span></span>,
        "<span class="hljs-attribute">parameters</span>":<span class="hljs-value">{
             "<span class="hljs-attribute">mask</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"unsigned char"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"bytemask"</span></span>,
                "<span class="hljs-attribute">default</span>":<span class="hljs-value"><span class="hljs-number">255</span></span>,
                "<span class="hljs-attribute">range</span>":<span class="hljs-value">{
                    "<span class="hljs-attribute">min</span>":<span class="hljs-value"><span class="hljs-number">0</span></span>,
                    "<span class="hljs-attribute">max</span>":<span class="hljs-value"><span class="hljs-number">255</span>
                </span>}
            </span>}
        </span>}</span>,
        "<span class="hljs-attribute">input_subjects</span>":
        <span class="hljs-value">{
            "<span class="hljs-attribute">data_in</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"byte"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"input"</span>
            </span>}
        </span>}</span>,
        "<span class="hljs-attribute">output_subjects</span>":<span class="hljs-value">{
            "<span class="hljs-attribute">data_out</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"byte"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"output"</span>
            </span>}
        </span>}</span>,
        "<span class="hljs-attribute">info</span>":<span class="hljs-value">{
            "<span class="hljs-attribute">auther</span>":<span class="hljs-value"><span class="hljs-string">"kelly"</span></span>,
            "<span class="hljs-attribute">version</span>":<span class="hljs-value">[<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]</span>,
            "<span class="hljs-attribute">mail</span>":<span class="hljs-value"><span class="hljs-string">"kelly@163.com"</span>
        </span>}
    </span>}</span>,
    "<span class="hljs-attribute">example_reverse</span>":<span class="hljs-value">{
        "<span class="hljs-attribute">name</span>":<span class="hljs-value"><span class="hljs-string">"reverse"</span></span>,
        "<span class="hljs-attribute">parameters</span>":<span class="hljs-value">{
         }</span>,
        "<span class="hljs-attribute">input_subjects</span>":
        <span class="hljs-value">{
            "<span class="hljs-attribute">data_in</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"byte"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"input"</span>
            </span>}
        </span>}</span>,
        "<span class="hljs-attribute">output_subjects</span>":<span class="hljs-value">{
            "<span class="hljs-attribute">data_out</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"byte"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"output"</span>
            </span>}
        </span>}</span>,
        "<span class="hljs-attribute">info</span>":<span class="hljs-value">{
            "<span class="hljs-attribute">auther</span>":<span class="hljs-value"><span class="hljs-string">"kelly"</span></span>,
            "<span class="hljs-attribute">version</span>":<span class="hljs-value">[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>]</span>,
            "<span class="hljs-attribute">mail</span>":<span class="hljs-value"><span class="hljs-string">"kelly@163.com"</span>
        </span>}
    </span>}
</span>}
</code></pre><p>As you can see, the file consists of two chunks. The first block is the Example_bitxor part, the second block is Example_reverse, which corresponds to two functions.</p><p>Within each function, the four sub-items (name, parameters, Input_subject, Output_subject) , respectively, corresponding to the friendly name, static properties, input subjects, output subjects.</p><p><strong>NOTE:</strong> Although each property contains a type indication of “type” and a range indication, the platform considers all input output as a byte stream. “type” and “range” is only intended to alert the user. A mature module should have a detailed interface document describing the input and output type, byte order, and size end. For text type, character set is very important. The above module, shown on the platform as:</p><p><img src="images/example_module.png" alt="example_module UI"></p><h3 id="3.5-command-line-arguments"><a name="3.5-command-line-arguments" href="#3.5-command-line-arguments"></a>3.5 Command-line arguments</h3><p>The Taskbus platform initiates the process based on the JSON file. When you start each function module, Taskbus feeds all the information through the command line parameters. There are several types of command-line arguments.</p><table>
<thead>
<tr>
<th>Tyoe</th>
<th>Paraments</th>
<th>Meaning</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>Process</td>
<td>——instance=&lt;M&gt;</td>
<td>Feeds the module to the process ID value</td>
<td>Used to differentiate between separate processes, this measure avoids the module itself to generate a unique ID</td>
</tr>
<tr>
<td>Process</td>
<td>——function=&lt;N&gt;</td>
<td>Specifies the function that the current instance should run.</td>
<td>A module can support many functions.</td>
</tr>
<tr>
<td>Process</td>
<td>——information</td>
<td>The platform Request module outputs JSON description and exits.</td>
<td>The module can be supplied with JSON files, or printf JSON in this parameter.</td>
</tr>
<tr>
<td>Subjects</td>
<td>——&lt;sub_name&gt;=&lt;K&gt;</td>
<td>Specify the ID of the Subject name to the module</td>
<td>The Subject name is determined by each module and can appear in multiple sections.</td>
</tr>
<tr>
<td>User Properties</td>
<td>——&lt;Key&gt;=&lt;Value&gt;</td>
<td>User-defined initialization properties</td>
<td>Can be set in the platform “Properties” column.</td>
</tr>
</tbody>
</table><p>As an example of the hello-world module, the following module, at startup, has the following command line:</p><pre class="bash hljs"><code class="bash" data-origin="<pre><code class=&quot;bash&quot;>user@local$ example_helloworld.exe --instance=6 --function=example_bitxor --mask=255 --data_in=6 --data_out=1
</code></pre>">user@<span class="hljs-built_in">local</span>$ example_helloworld.exe --instance=<span class="hljs-number">6</span> --function=example_bitxor --mask=<span class="hljs-number">255</span> --data_<span class="hljs-keyword">in</span>=<span class="hljs-number">6</span> --data_out=<span class="hljs-number">1</span>
</code></pre><p><img src="images/commandline_en.png" alt="Paths UI"></p><h3 id="3.6-first-hello-world-module"><a name="3.6-first-hello-world-module" href="#3.6-first-hello-world-module"></a>3.6 First Hello-world module</h3><p>We paste the code of the Hellowold module here, using C + +, it is very convenient to implement the above functions.</p><ul>
<li>The code does not use any features other than the standard C + +</li><li>in fact, in the fourth chapter you can see that we have done a lot of simplification for the access platform in advance. But simplifying the work will obscure the details, and the following code is still a good example of how the module works.</li></ul><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>#include &amp;lt;cstdio&amp;gt;
#include &amp;lt;string&amp;gt;
#include &amp;lt;cstring&amp;gt;
#include &amp;lt;cstdlib&amp;gt;
#ifdef WINNT
#include &amp;lt;io.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;
#endif
using namespace std;
#define MAX_DTALEN 65536
int main(int argc, char * argv[])
{
    //In windows, stdio must be set to BINARY mode, to
    //prevent linebreak \\n\\r replace.
#ifdef WINNT
    setmode(fileno(stdout),O_BINARY);
    setmode(fileno(stdin),O_BINARY);
#endif
    bool bInfo = false, finished = false;
    int instance = 0;
    int sub_input = 0, sub_output = 0;
    char mask = 0;
    string function;
    //1. parse cmdline
    for (int i=1;i&amp;lt;argc;++i)
    {
        string arg_key = argv[i], arg_value = argv[i];
        int idx = arg_key.find('=');
        if (idx&amp;gt;=0 &amp;amp;&amp;amp; idx&amp;lt;arg_key.size())
        {
            arg_key = arg_key.substr(0,idx);
            arg_value = arg_value.substr(idx+1);
        }
        if (arg_key==&quot;--function&quot;)
            function = arg_value;
        else if (arg_key==&quot;--information&quot;)
            bInfo = true;
        else if (arg_key==&quot;--instance&quot;)
            instance = atoi(arg_value.c_str());
        else if (arg_key==&quot;--data_in&quot;)
            sub_input = atoi(arg_value.c_str());
        else if (arg_key==&quot;--data_out&quot;)
            sub_output = atoi(arg_value.c_str());
        else if (arg_key==&quot;--mask&quot;)
            mask = atoi(arg_value.c_str());
        fprintf(stderr,&quot;%s:%s\n&quot;,arg_key.c_str(),arg_value.c_str());
        fflush(stderr);
    }
    //2. function case
    if (bInfo)
    {
        //In this example, json file will be published with exe file.
        //We will return directly.  Or, you can output json here to stdout,
        //If you do not want to publish your json file.
        return 0;
    }
    else if (instance&amp;lt;=0 || function.length()==0)
        return -1;
    else
    {
        char header[4], data[MAX_DTALEN+1];
        memset(data,0,MAX_DTALEN+1);
        int n_sub = 0, n_path = 0, n_len = 0;
        while(false==finished)
        {
            fread(header,1,4,stdin);    //2.1 read header
            if (header[0]!=0x3C || header[1]!=0x5A || header[2]!=0x7E || header[3]!=0x69)
            {
                fprintf(stderr,&quot;Bad header\n&quot;);
                break;
            }
            fread(&amp;amp;n_sub,sizeof(int),1,stdin);
            fread(&amp;amp;n_path,sizeof(int),1,stdin);
            fread(&amp;amp;n_len,sizeof(int),1,stdin);
            if (n_len&amp;lt;0 || n_len &amp;gt;MAX_DTALEN)
            {
                fprintf(stderr,&quot;Bad length %d\n&quot;,n_len);
                break;
            }
            fread(data,sizeof(char),n_len,stdin);

            if (n_sub&amp;lt;=0)
            {
                if (strstr(data, &quot;quit&quot;)!=nullptr)
                {
                    finished = true;
                    continue;
                }
            }
            else if (n_sub != sub_input)
                continue;

            if (function==&quot;example_bitxor&quot;)
            {
                for (int i=0;i&amp;lt;n_len;++i)
                    data[i] ^= mask;
            }
            else if (function==&quot;example_reverse&quot;)
            {
                for (int i=0;i&amp;lt;n_len/2;++i)
                {
                    char t = data[i];
                    data[i] = data[n_len-1-i];
                    data[n_len-1-i] = t;
                }
            }
            else
            {
                fprintf(stderr,&quot;Unknown function %s\n&quot;,function.c_str());
                break;
            }
            fwrite(header,1,4,stdout);
            fwrite(&amp;amp;sub_output,sizeof(int),1,stdout);
            fwrite(&amp;amp;n_path,sizeof(int),1,stdout);
            fwrite(&amp;amp;n_len,sizeof(int),1,stdout);
            fwrite(data,sizeof(char),n_len,stdout);
            fflush(stdout);
        }
    }
    //3.exit
    return 0;
}
</code></pre>"><span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;cstdio&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;string&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;cstring&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;cstdlib&gt;</span>
<span class="hljs-preprocessor">#ifdef WINNT</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;io.h&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> &lt;fcntl.h&gt;</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">endif</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-preprocessor">#<span class="hljs-keyword">define</span> MAX_DTALEN 65536</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> * argv[])</span>
</span>{
    <span class="hljs-comment">//In windows, stdio must be set to BINARY mode, to</span>
    <span class="hljs-comment">//prevent linebreak \\n\\r replace.</span>
<span class="hljs-preprocessor">#ifdef WINNT</span>
    setmode(fileno(stdout),O_BINARY);
    setmode(fileno(stdin),O_BINARY);
<span class="hljs-preprocessor">#<span class="hljs-keyword">endif</span></span>
    <span class="hljs-keyword">bool</span> bInfo = <span class="hljs-keyword">false</span>, finished = <span class="hljs-keyword">false</span>;
    <span class="hljs-keyword">int</span> instance = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">int</span> sub_input = <span class="hljs-number">0</span>, sub_output = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">char</span> mask = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">string</span> function;
    <span class="hljs-comment">//1. parse cmdline</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;argc;++i)
    {
        <span class="hljs-built_in">string</span> arg_key = argv[i], arg_value = argv[i];
        <span class="hljs-keyword">int</span> idx = arg_key.find(<span class="hljs-string">'='</span>);
        <span class="hljs-keyword">if</span> (idx&gt;=<span class="hljs-number">0</span> &amp;&amp; idx&lt;arg_key.size())
        {
            arg_key = arg_key.substr(<span class="hljs-number">0</span>,idx);
            arg_value = arg_value.substr(idx+<span class="hljs-number">1</span>);
        }
        <span class="hljs-keyword">if</span> (arg_key==<span class="hljs-string">"--function"</span>)
            function = arg_value;
        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(arg_key=="--information")</span>
            bInfo </span>= <span class="hljs-keyword">true</span>;
        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(arg_key=="--instance")</span>
            instance </span>= atoi(arg_value.c_str());
        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(arg_key=="--data_in")</span>
            sub_input </span>= atoi(arg_value.c_str());
        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(arg_key=="--data_out")</span>
            sub_output </span>= atoi(arg_value.c_str());
        <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(arg_key=="--mask")</span>
            mask </span>= atoi(arg_value.c_str());
        <span class="hljs-built_in">fprintf</span>(stderr,<span class="hljs-string">"%s:%s\n"</span>,arg_key.c_str(),arg_value.c_str());
        fflush(stderr);
    }
    <span class="hljs-comment">//2. function case</span>
    <span class="hljs-keyword">if</span> (bInfo)
    {
        <span class="hljs-comment">//In this example, json file will be published with exe file.</span>
        <span class="hljs-comment">//We will return directly.  Or, you can output json here to stdout,</span>
        <span class="hljs-comment">//If you do not want to publish your json file.</span>
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
    <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(instance&lt;=0 || function.length()</span></span>==<span class="hljs-number">0</span>)
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-keyword">char</span> header[<span class="hljs-number">4</span>], data[MAX_DTALEN+<span class="hljs-number">1</span>];
        <span class="hljs-built_in">memset</span>(data,<span class="hljs-number">0</span>,MAX_DTALEN+<span class="hljs-number">1</span>);
        <span class="hljs-keyword">int</span> n_sub = <span class="hljs-number">0</span>, n_path = <span class="hljs-number">0</span>, n_len = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span>(<span class="hljs-keyword">false</span>==finished)
        {
            fread(header,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,stdin);    <span class="hljs-comment">//2.1 read header</span>
            <span class="hljs-keyword">if</span> (header[<span class="hljs-number">0</span>]!=<span class="hljs-number">0x3C</span> || header[<span class="hljs-number">1</span>]!=<span class="hljs-number">0x5A</span> || header[<span class="hljs-number">2</span>]!=<span class="hljs-number">0x7E</span> || header[<span class="hljs-number">3</span>]!=<span class="hljs-number">0x69</span>)
            {
                <span class="hljs-built_in">fprintf</span>(stderr,<span class="hljs-string">"Bad header\n"</span>);
                <span class="hljs-keyword">break</span>;
            }
            fread(&amp;n_sub,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
            fread(&amp;n_path,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
            fread(&amp;n_len,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdin);
            <span class="hljs-keyword">if</span> (n_len&lt;<span class="hljs-number">0</span> || n_len &gt;MAX_DTALEN)
            {
                <span class="hljs-built_in">fprintf</span>(stderr,<span class="hljs-string">"Bad length %d\n"</span>,n_len);
                <span class="hljs-keyword">break</span>;
            }
            fread(data,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">char</span>),n_len,stdin);

            <span class="hljs-keyword">if</span> (n_sub&lt;=<span class="hljs-number">0</span>)
            {
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(data, <span class="hljs-string">"quit"</span>)!=<span class="hljs-keyword">nullptr</span>)
                {
                    finished = <span class="hljs-keyword">true</span>;
                    <span class="hljs-keyword">continue</span>;
                }
            }
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(n_sub != sub_input)</span>
                <span class="hljs-keyword">continue</span></span>;

            <span class="hljs-keyword">if</span> (function==<span class="hljs-string">"example_bitxor"</span>)
            {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n_len;++i)
                    data[i] ^= mask;
            }
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(function=="example_reverse")</span>
            </span>{
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n_len/<span class="hljs-number">2</span>;++i)
                {
                    <span class="hljs-keyword">char</span> t = data[i];
                    data[i] = data[n_len-<span class="hljs-number">1</span>-i];
                    data[n_len-<span class="hljs-number">1</span>-i] = t;
                }
            }
            <span class="hljs-keyword">else</span>
            {
                <span class="hljs-built_in">fprintf</span>(stderr,<span class="hljs-string">"Unknown function %s\n"</span>,function.c_str());
                <span class="hljs-keyword">break</span>;
            }
            fwrite(header,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,stdout);
            fwrite(&amp;sub_output,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdout);
            fwrite(&amp;n_path,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdout);
            fwrite(&amp;n_len,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>),<span class="hljs-number">1</span>,stdout);
            fwrite(data,<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">char</span>),n_len,stdout);
            fflush(stdout);
        }
    }
    <span class="hljs-comment">//3.exit</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre><h2 id="4.-development-guide"><a name="4.-development-guide" href="#4.-development-guide"></a>4. Development Guide</h2><p>We will take FFTW as an example of how to create a Taskbus module from 0 onwards.</p><h3 id="4.1-design-functions-and-writing-json-file"><a name="4.1-design-functions-and-writing-json-file" href="#4.1-design-functions-and-writing-json-file"></a>4.1 Design functions and writing JSON file</h3><p>The first step in creating a module is to design the function and determine the interface, properties, and composition of the JSON file. The quickest way to compose a JSON file is to modify it from an example and save it as a JSON file with the same name as the executable. Writing Asian characters with UTF-8 encoding facilitates loading speed. As long as there is a JSON file, even if the module is not fully implemented, you can see the effect on the platform. The FFT module that we want to design should have the following structure:</p><p><img src="images/fftw.png" alt="FFTW"></p><p>It has two input interface (Subject, “tmstamp_in” and “signal”)  ,  three output interface (“tmstamp_out”, “Spec in Comples”, “FFT in dB”). You can support the user to configure three static parameters: the number of FFT points, input signal bands, sample data type . These static parameters can be modified in the “Properties” section when the user clicks the icon, similar to the following image:</p><p><img src="images/fftw_para.png" alt="fftw_para"></p><p>The feature description file with the above features is as follows:</p><pre class="json hljs"><code class="json" data-origin="<pre><code class=&quot;json&quot;>{
    &quot;transform_fft&quot;:{
        &quot;name&quot;:&quot;libfftw&quot;,
        &quot;parameters&quot;:{
             &quot;sptype&quot;:{
                &quot;type&quot;:&quot;enum&quot;,
                &quot;tooltip&quot;:&quot;sample point format&quot;,
                &quot;default&quot;:0,
                &quot;range&quot;:{
                    &quot;0&quot;:&quot;16 bit Intel&quot;,
                    &quot;1&quot;:&quot;16 bit Moto&quot;,
                    &quot;2&quot;:&quot;int8&quot;,
                    &quot;3&quot;:&quot;uint8&quot;
                }
            },
             &quot;channels&quot;:{
                &quot;type&quot;:&quot;int&quot;,
                &quot;tooltip&quot;:&quot;Channels&quot;,
                &quot;default&quot;:1
            },            
            &quot;fftsize&quot;:{
                &quot;type&quot;:&quot;int&quot;,
                &quot;tooltip&quot;:&quot;fft size&quot;,
                &quot;default&quot;:1024
            }

        },
        &quot;input_subjects&quot;:
        {
            &quot;signal&quot;:{
                &quot;type&quot;:&quot;byte&quot;,
                &quot;tooltip&quot;:&quot;signal&quot;
            },
            &quot;tmstamp_in&quot;:{
                &quot;type&quot;:&quot;unsigned long long&quot;,
                &quot;tooltip&quot;:&quot;tmstamp_in&quot;
            }
        },
        &quot;output_subjects&quot;:{           
            &quot;FFT&quot;:{
                &quot;type&quot;:&quot;vector&quot;,
                &quot;tooltip&quot;:&quot;FFT in dB&quot;
            },
            &quot;Spec&quot;:{
                &quot;type&quot;:&quot;vector&quot;,
                &quot;tooltip&quot;:&quot;Spec in Complex&quot;
            },
            &quot;tmstamp_out&quot;:{
                &quot;type&quot;:&quot;unsigned long long&quot;,
                &quot;tooltip&quot;:&quot;tmstamp_out&quot;
            }

        }
    }
}
</code></pre>">{
    "<span class="hljs-attribute">transform_fft</span>":<span class="hljs-value">{
        "<span class="hljs-attribute">name</span>":<span class="hljs-value"><span class="hljs-string">"libfftw"</span></span>,
        "<span class="hljs-attribute">parameters</span>":<span class="hljs-value">{
             "<span class="hljs-attribute">sptype</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"enum"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"sample point format"</span></span>,
                "<span class="hljs-attribute">default</span>":<span class="hljs-value"><span class="hljs-number">0</span></span>,
                "<span class="hljs-attribute">range</span>":<span class="hljs-value">{
                    "<span class="hljs-attribute">0</span>":<span class="hljs-value"><span class="hljs-string">"16 bit Intel"</span></span>,
                    "<span class="hljs-attribute">1</span>":<span class="hljs-value"><span class="hljs-string">"16 bit Moto"</span></span>,
                    "<span class="hljs-attribute">2</span>":<span class="hljs-value"><span class="hljs-string">"int8"</span></span>,
                    "<span class="hljs-attribute">3</span>":<span class="hljs-value"><span class="hljs-string">"uint8"</span>
                </span>}
            </span>}</span>,
             "<span class="hljs-attribute">channels</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"int"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"Channels"</span></span>,
                "<span class="hljs-attribute">default</span>":<span class="hljs-value"><span class="hljs-number">1</span>
            </span>}</span>,            
            "<span class="hljs-attribute">fftsize</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"int"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"fft size"</span></span>,
                "<span class="hljs-attribute">default</span>":<span class="hljs-value"><span class="hljs-number">1024</span>
            </span>}

        </span>}</span>,
        "<span class="hljs-attribute">input_subjects</span>":
        <span class="hljs-value">{
            "<span class="hljs-attribute">signal</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"byte"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"signal"</span>
            </span>}</span>,
            "<span class="hljs-attribute">tmstamp_in</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"unsigned long long"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"tmstamp_in"</span>
            </span>}
        </span>}</span>,
        "<span class="hljs-attribute">output_subjects</span>":<span class="hljs-value">{           
            "<span class="hljs-attribute">FFT</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"vector"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"FFT in dB"</span>
            </span>}</span>,
            "<span class="hljs-attribute">Spec</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"vector"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"Spec in Complex"</span>
            </span>}</span>,
            "<span class="hljs-attribute">tmstamp_out</span>":<span class="hljs-value">{
                "<span class="hljs-attribute">type</span>":<span class="hljs-value"><span class="hljs-string">"unsigned long long"</span></span>,
                "<span class="hljs-attribute">tooltip</span>":<span class="hljs-value"><span class="hljs-string">"tmstamp_out"</span>
            </span>}

        </span>}
    </span>}
</span>}
</code></pre><p>Once you have the JSON file, you can load and edit it on the platform as long as you have a blank executable file (with the same file name and extension). Of course it does not work unless we go on with following chapters.</p><h3 id="4.2-accelerate-development-progress-with-toolcodes"><a name="4.2-accelerate-development-progress-with-toolcodes" href="#4.2-accelerate-development-progress-with-toolcodes"></a>4.2 Accelerate development progress with toolcodes</h3><p>If you use feature-rich languages such as C #, it is easier to do operations such as command-line parsing. For C++, taskBus platform provides source code that can directly accelerate development speed. Using these source codes will significantly improve development efficiency and simplify the amount of code.</p><h4 id="4.2.1-command-line-interpretation"><a name="4.2.1-command-line-interpretation" href="#4.2.1-command-line-interpretation"></a>4.2.1 Command Line Interpretation</h4><p>The first step in implementing module functionality is to get command-line arguments. You can use HelloWorld code to implement command-line parsing, but that makes it more complicated. Using the provided classes, command-line parsing and extraction becomes very simple. Whether it is QT, C++ or MFC, you can take similar measures.</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>#include &quot;cmdlineparser.h&quot;
#include &quot;tb_interface.h&quot;
using namespace TASKBUS;
int main(int argc , char * argv[])
{
    init_client();
    cmdlineParser args(argc,argv);
    if (args.contains(&quot;information&quot;))
        putjson();
    else if (args.contains(&quot;function&quot;,&quot;tranform_fft&quot;))
    {
        const int instance        = args.toInt(&quot;instance&quot;,0);
        const int isource        = args.toInt(&quot;signal&quot;,0);
        const int FFT              = args.toInt(&quot;FFT&quot;,0);
        const int Spec             = args.toInt(&quot;Spec&quot;,0);
        const int itmstamp_in  = args.toInt(&quot;tmstamp_in&quot;,0);
        const int itmstamp_out = args.toInt(&quot;tmstamp_out&quot;,0);
        const int sptype    =    args.toInt(&quot;sptype&quot;,0);
        const int channels    =    args.toInt(&quot;channels&quot;,1);
        const int fftsize    =  args.toInt(&quot;fftsize&quot;,1024);
        //...work
    }
    else
        fprintf(stderr,&quot;Error:Function does not exits.&quot;);
    return 0;
}
</code></pre>"><span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "cmdlineparser.h"</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> "tb_interface.h"</span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> TASKBUS;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc , <span class="hljs-keyword">char</span> * argv[])</span>
</span>{
    init_client();
    <span class="hljs-function">cmdlineParser <span class="hljs-title">args</span><span class="hljs-params">(argc,argv)</span></span>;
    <span class="hljs-keyword">if</span> (args.contains(<span class="hljs-string">"information"</span>))
        putjson();
    <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(args.contains("function","tranform_fft")</span>)
    </span>{
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> instance        = args.toInt(<span class="hljs-string">"instance"</span>,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> isource        = args.toInt(<span class="hljs-string">"signal"</span>,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> FFT              = args.toInt(<span class="hljs-string">"FFT"</span>,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> Spec             = args.toInt(<span class="hljs-string">"Spec"</span>,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> itmstamp_in  = args.toInt(<span class="hljs-string">"tmstamp_in"</span>,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> itmstamp_out = args.toInt(<span class="hljs-string">"tmstamp_out"</span>,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> sptype    =    args.toInt(<span class="hljs-string">"sptype"</span>,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> channels    =    args.toInt(<span class="hljs-string">"channels"</span>,<span class="hljs-number">1</span>);
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> fftsize    =  args.toInt(<span class="hljs-string">"fftsize"</span>,<span class="hljs-number">1024</span>);
        <span class="hljs-comment">//...work</span>
    }
    <span class="hljs-function"><span class="hljs-keyword">else</span>
        <span class="hljs-title">fprintf</span><span class="hljs-params">(stderr,"Error:Function does not exits.")</span></span>;
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre><p>For examples of QT, MFC, C#, you can refer to sample projects.</p><h4 id="4.2.2-data-sending-and-receiving"><a name="4.2.2-data-sending-and-receiving" href="#4.2.2-data-sending-and-receiving"></a>4.2.2 Data sending and receiving</h4><p>The data throughput format for Taskbus is fixed. It strictly follows the following order:</p><table>
<thead>
<tr>
<th>package</th>
<th>record</th>
<th>type</th>
<th>length(bytes)</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>header</td>
<td>unsigned char [4]</td>
<td>4</td>
<td>Always be 0x3C,0x5A,0x7E,0x69 for debug with WINHEX</td>
</tr>
<tr>
<td>1</td>
<td>subject_id</td>
<td>int</td>
<td>4</td>
<td>0: Control commands, &gt;0:user subjects, &lt;0 reserved</td>
</tr>
<tr>
<td>1</td>
<td>path_id</td>
<td>int</td>
<td>4</td>
<td>&gt;=0:user subjects, &lt;0 reserved</td>
</tr>
<tr>
<td>1</td>
<td>data_len</td>
<td>int</td>
<td>4</td>
<td>&gt;0, following data length in bytes</td>
</tr>
<tr>
<td>1</td>
<td>data</td>
<td>unsigned char</td>
<td>data_len</td>
<td>&gt;0, data in bytes</td>
</tr>
<tr>
<td>2</td>
<td>header</td>
<td>unsigned char [4]</td>
<td>4</td>
<td>0x3C,0x5A,0x7E,0x69</td>
</tr>
<tr>
<td>2</td>
<td>subject_id</td>
<td>int</td>
<td>4</td>
<td>0: Control commands, &gt;0:user subjects, &lt;0 reserved</td>
</tr>
<tr>
<td>2</td>
<td>path_id</td>
<td>int</td>
<td>4</td>
<td>&gt;=0:user subjects, &lt;0 reserved</td>
</tr>
<tr>
<td>2</td>
<td>data_len</td>
<td>int</td>
<td>4</td>
<td>&gt;0, following data length in bytes</td>
</tr>
<tr>
<td>2</td>
<td>data</td>
<td>unsigned char</td>
<td>data_len</td>
<td>&gt;0, data in bytes</td>
</tr>
<tr>
<td>3…</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table><p>Using tool code, you can do data sending and receiving directly. The main push functions are:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>    void push_subject(
        const unsigned int subject_id,
        const unsigned int path_id,
        const unsigned int data_length,
        const unsigned char   *dataptr
        );
    void push_subject(
        const unsigned int subject_id,
        const unsigned int path_id,
        const char   *dataptr
        );
    void push_subject(
        const unsigned char   *allptr,
        const unsigned int totalLength
        );
    void push_subject(
        const subject_package_header header,
        const unsigned char   *dataptr
        );
</code></pre>">    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push_subject</span><span class="hljs-params">(
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> subject_id,
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> path_id,
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> data_length,
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>   *dataptr
        )</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push_subject</span><span class="hljs-params">(
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> subject_id,
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> path_id,
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>   *dataptr
        )</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push_subject</span><span class="hljs-params">(
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>   *allptr,
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> totalLength
        )</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push_subject</span><span class="hljs-params">(
        <span class="hljs-keyword">const</span> subject_package_header header,
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>   *dataptr
        )</span></span>;
</code></pre><p>The receive function (blocking) is:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>   std::vector&amp;lt;unsigned char&amp;gt; pull_subject(  subject_package_header * header  );
</code></pre>">   <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>&gt; pull_subject(  subject_package_header * header  );
</code></pre><p><strong>Performance Tip:</strong>The function above returns a vector directly that contains the data content of a complete packet (excluding the head). Because the c++14 above standard is used by default, returning std::vector&lt;unsigned char&gt; does not result in a deep memory copy, but rather triggers a right value reference with memory delivery.</p><p>The sending and receiving code snippet using the tool functions described above is as follows:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>        while (false==bfinished)
        {
            subject_package_header header;
            vector&amp;lt;unsigned char&amp;gt; packagedta = pull_subject(&amp;amp;header);
            if (is_valid_header(header)==false)
                break;
            if ( is_control_subject(header))
            {                
                if (strstr(control_subject(header,packagedta).c_str(),&quot;\&quot;quit\&quot;:&quot;)!=nullptr)
                    bfinished = true;
            }
            else if (header.subject_id==source)
            {
                //...fft
                //output
                if (FFT&amp;gt;0)
                    push_subject(FFT,header.path_id,fftsize*sizeof(double),(const unsigned char *)vec_fft_abs.data());
                if (Spec&amp;gt;0)
                    push_subject(Spec,header.path_id,fftsize*sizeof(double),(const unsigned char *)out);
            }
        }
</code></pre>">        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">false</span>==bfinished)
        {
            subject_package_header header;
            <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>&gt; packagedta = pull_subject(&amp;header);
            <span class="hljs-keyword">if</span> (is_valid_header(header)==<span class="hljs-keyword">false</span>)
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">if</span> ( is_control_subject(header))
            {                
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(control_subject(header,packagedta).c_str(),<span class="hljs-string">"\"quit\":"</span>)!=<span class="hljs-keyword">nullptr</span>)
                    bfinished = <span class="hljs-keyword">true</span>;
            }
            <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(header.subject_id==source)</span>
            </span>{
                <span class="hljs-comment">//...fft</span>
                <span class="hljs-comment">//output</span>
                <span class="hljs-keyword">if</span> (FFT&gt;<span class="hljs-number">0</span>)
                    push_subject(FFT,header.path_id,fftsize*<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">double</span>),(<span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *)vec_fft_abs.data());
                <span class="hljs-keyword">if</span> (Spec&gt;<span class="hljs-number">0</span>)
                    push_subject(Spec,header.path_id,fftsize*<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">double</span>),(<span class="hljs-keyword">const</span> <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *)out);
            }
        }
</code></pre><h4 id="4.2.3-debugging"><a name="4.2.3-debugging" href="#4.2.3-debugging"></a>4.2.3 Debugging</h4><p>Tracking debugging from a platform process is very complex. Even for a simple module, you must roam through the binary machine code developed by the compiler in different languages. Fortunately, Taskbus offers a very clever and simple offline debugging solution that allows you to debug the module itself individually and connect to the platform at any time.</p><p>The core idea of debugging is the overloading of the input and output pipeline. taskBus platform can record all the input and output data, command-line startup parameters and other features of a module to disk as needed. Then, when you debug the platform, you can implement scene playback whenever you specify a recording folder.</p><h5 id="(1)turn-on-debug-and-recording-data"><a name="(1)turn-on-debug-and-recording-data" href="#(1)turn-on-debug-and-recording-data"></a>(1)Turn on debug and recording data</h5><p>Selecting the module in the main interface and clicking the Start Debugging button will turn on the recording.</p><p><img src="images/turnon_debug.png" alt="turnon_debug"></p><p>Once the entire project starts running, the recorded data is continuously recorded in the Debug folder. The subfolder is named as the current operating system process ID. There are 3 files under the folder, corresponding to Stdin,stdout,stderr. Note that in order to capture all exceptions, the platform will remain exclusive to the log files until the next debug starts running. Therefore, in order to end recording, you need to close the platform or start the project again.</p><p><img src="images/debug_folder.png" alt="turnon_debug"></p><h5 id="(2)playback-and-debugging"><a name="(2)playback-and-debugging" href="#(2)playback-and-debugging"></a>(2)Playback and debugging</h5><p>The key technology is based on “freopen()”. This feature redirects the actual source to the file while keeping the file handle unchanged. The user can implement it himself through a statement, and once the following statement is executed, the data throughput section of the above will automatically use the data recorded in the file:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>    std::string fm_stdin = strpath + &quot;/stdin.dat&quot;;
    freopen(fm_stdin.c_str(),&quot;rb&quot;,stdin);
</code></pre>">    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> fm_stdin = strpath + <span class="hljs-string">"/stdin.dat"</span>;
    freopen(fm_stdin.c_str(),<span class="hljs-string">"rb"</span>,stdin);
</code></pre><p>For CPP, the platform is ready for handy tool functions. A code that supports switching debug mode, Normal mode, only needs to add a few lines of code to the main portal:</p><pre class="cpp hljs"><code class="cpp" data-origin="<pre><code class=&quot;cpp&quot;>using namespace TASKBUS;
const int OFFLINEDEBUG = 0;
int main(int argc , char * argv[])
{
    init_client();
    cmdlineParser args;
    if (OFFLINEDEBUG==0)
        args.parser(argc,argv);
    else
    {
        auto ars = debug(&quot;debug/pid21580&quot;);
        args.parser(ars);
    }
    //...
}
</code></pre>"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> TASKBUS;
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> OFFLINEDEBUG = <span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc , <span class="hljs-keyword">char</span> * argv[])</span>
</span>{
    init_client();
    cmdlineParser args;
    <span class="hljs-keyword">if</span> (OFFLINEDEBUG==<span class="hljs-number">0</span>)
        args.parser(argc,argv);
    <span class="hljs-keyword">else</span>
    {
        <span class="hljs-keyword">auto</span> ars = debug(<span class="hljs-string">"debug/pid21580"</span>);
        args.parser(ars);
    }
    <span class="hljs-comment">//...</span>
}
</code></pre><p>In the code above, the previously recorded command-line arguments and input data are read from the debug/pid21580 folder. This way, you can debug it independently. Don’t forget to set the debug switch OFFLINEDEBUG to 0 after you finish debugging.</p><h3 id="4.3-data-processing"><a name="4.3-data-processing" href="#4.3-data-processing"></a>4.3 Data Processing</h3><p>In the preceding example, data is Immediately processed, that is the simplest case. In many scenarios we need to deal with data cache and multiplex processing problems. Load control is also an issue to consider for a large data flow or time-consuming operation.</p><h4 id="4.3.1-data-caching-recommendations"><a name="4.3.1-data-caching-recommendations" href="#4.3.1-data-caching-recommendations"></a>4.3.1 Data Caching recommendations</h4><p>It is recommended to use the STL library.</p><ul>
<li>If you need to cache old data, using the STL container is a very suitable choice.</li><li>For different paths (path_id), the cache should be independent. At this point, std::map&lt;path_id, cache&gt; will provide very good maneuverability.</li><li>use nested map, vector, list to implement very complex dynamic data structures.</li><li>It’s also a good idea to use the smart pointer “shared_ptr”.</li></ul><h4 id="4.3.2-load-control"><a name="4.3.2-load-control" href="#4.3.2-load-control"></a>4.3.2 Load control</h4><p>Unlike Gnuradio’s pulling, Taskbus producers push the data. When computing resources are abundant, designers do not need to consider the problem of load control. However, in time-consuming processing, if there is no measure to protect, the bottleneck module may result in increasing memory overhead across the platform. Producers continue to write to stdout, the platform output to the consumer’s stdin, seemingly no problem. In fact, under Windows, the platform writes the cache of the operating system. If consumers are unable to consume the cache in a timely manner, the cache will continue to grow.</p><p>For flexibility reasons, Taskbus left the issue to the module designer. Module designers can solve this problem with at least two simple strategies.</p><ul>
<li><p>Method 1, by setting the signal source rate, ensure that the signal is less than the processing limit of the rate of generation.</p>
</li><li><p>Method 2, The consumer outputs the data timestamp and interconnects it back to the producer to form a closed loop. The producer detects the back of the connection timestamp. If significantly lower than the current production schedule, the producer slows down the production schedule.</p>
</li></ul><p>Strategy 2 is used for the following example project.Technical details Reference Sample project Source_soundcard.</p><p><img src="images/antiblocking.png" alt="antiblocking"></p><h3 id="4.4-runtime-and-deploy"><a name="4.4-runtime-and-deploy" href="#4.4-runtime-and-deploy"></a>4.4 Runtime and deploy</h3><p>The Taskbus runtime provides a traversal for Green Publishing (Copy-deployment), and developers can adjust the path settings by referring to the following sections.</p><h4 id="4.4.1-path-policy"><a name="4.4.1-path-policy" href="#4.4.1-path-policy"></a>4.4.1 Path Policy</h4><p>The current path will be changed to the path where the Taskbusplatform executable file is located when the platform started. Taskbusplatform reads all known modules that are listed in Default_mods.text . In this file, each row stores the executable file location of a module, and an example looks like this:</p><pre><code class="text" data-origin="<pre><code class=&quot;text&quot;>../../../examples/voice_spec.exe
modules/network_p2p.exe
modules/sink_file.exe
modules/example_helloworld.exe
modules/source_files.exe
modules/transform_fft.exe
modules/sink_SQL.exe
modules/source_soundcard.exe
modules/sink_plots.exe
</code></pre>">../../../examples/voice_spec.exe
modules/network_p2p.exe
modules/sink_file.exe
modules/example_helloworld.exe
modules/source_files.exe
modules/transform_fft.exe
modules/sink_SQL.exe
modules/source_soundcard.exe
modules/sink_plots.exe
</code></pre><p>Taskbusplatform will try to use relative path unless the character length of the absolute path is less than the relative path. Therefore, for a system that needs to be published, you can place all modules in the path where the Taskbusplatform executable file is located. Managed with subfolders such as folder modules or subs is a good way. Once you’ve done this, copy it to a new computer and run it without setting it up.</p><h4 id="4.4.2-sub-projects-and-nesting"><a name="4.4.2-sub-projects-and-nesting" href="#4.4.2-sub-projects-and-nesting"></a>4.4.2 Sub-Projects and nesting</h4><p>a taskBus project can be referenced by other projects. All suspended pins are assigned temporary IDs and exposed for external engineering links. Taking the FFT of the sound card as an example, we can combine the sound card and FFT into a “sound spectrum” module.</p><h5 id="(1)-create-a-sub-project"><a name="(1)-create-a-sub-project" href="#(1)-create-a-sub-project"></a>(1) Create a sub project</h5><p>Create a new subproject with the following structure:</p><p><img src="images/new_subprj.png" alt="new_subprj"></p><ul>
<li>This subproject consists of two modules, a sound card module and a FFT module.</li><li>The output pin of the FFT module is suspended as the external interface of the subproject.</li><li>If there are two suspended interfaces of the same name, the IDs assigned by the corresponding process are used to make the distinction.</li></ul><p>Save this subproject as a TBJ file, such as “VOICE_SPEC.TBJ”.</p><h5 id="(2)-attach-a-wrapper-file"><a name="(2)-attach-a-wrapper-file" href="#(2)-attach-a-wrapper-file"></a>(2) Attach a wrapper file</h5><p>Copy the wrapper “Subtask_warpper.exe” that comes with the platform to the same folder as “Voice_spec.tbj”, named “Voice_spec.exe”</p><ul>
<li>Voice_spec.exe will automatically read VOICE_SPEC.TBJ and tell the platform its own interface.</li><li>Under Linux, there is no exe extension.</li></ul><h5 id="(3)-attach-default-module-load-script"><a name="(3)-attach-default-module-load-script" href="#(3)-attach-default-module-load-script"></a>(3) Attach default module load script</h5><p>Since voice_spec needs to load the module itself, it is necessary to copy the Default_mods.text under the TaskBusPlatform.exe folder to the same folder as “voice_spec.tbj”, named “voice_spec.text”</p><ul>
<li><p>because the current running path of the platform is always the path of taskBusPlatform.exe, the relative path in the file Voice_spec.text remains the same as Default_mods.text. Users do not need additional editing.</p>
</li><li><p>However, you still need to review the file file Voice_spec.text to clear useless entries.</p>
</li><li><strong>In particular, it is important to note that the entry line for the Voice_spec module cannot be included in the file Voice_spec.text. This results in recursive loading, starting hundreds of child processes to slow down the system</strong></li></ul><p>When 2 and 3 are complete, the folder looks like this：</p><p><img src="images/subprj_folder.png" alt="subprj_folder"></p><p>File Voice_spec.text was modified to:</p><pre><code class="text" data-origin="<pre><code class=&quot;text&quot;>modules/source_soundcard.exe
modules/transform_fft.exe
</code></pre>">modules/source_soundcard.exe
modules/transform_fft.exe
</code></pre><h5 id="(4)-load-subproject-into-taskbusplatform"><a name="(4)-load-subproject-into-taskbusplatform" href="#(4)-load-subproject-into-taskbusplatform"></a>(4) Load Subproject into taskBusPlatform</h5><p>After you load the subproject module “Voice_spec.exe” in the platform, you can drag the module into the design area as a whole:</p><p><img src="images/subprj_emb.png" alt="subprj_emb"></p><ul>
<li>Double-click the Voice_spec icon can open the subproject.</li></ul><h3 id="4.5-multi-platform,-distributed-and-scalable"><a name="4.5-multi-platform,-distributed-and-scalable" href="#4.5-multi-platform,-distributed-and-scalable"></a>4.5 Multi-platform, distributed and scalable</h3><p>The Taskbus core uses Qt development and is a cross-platform structural framework that can run on all platforms that support Qt. At the same time, through the introduction of the corresponding modules, Taskbus can be more convenient to achieve distributed computing. In the code example, a TCP-based point-to-point transport module and a database logging module that accepts SQL scripts are included.</p><p>In addition to supporting the use of C + +, C #, VB and other compiled languages, Taskbus can also be directly referenced by the wrapper Python,lua,perl,ruby,matlab as a module, very flexible.</p><p>Specific examples refer to the accompanying code.</p><h2 id="5-about-taskbus"><a name="5-about-taskbus" href="#5-about-taskbus"></a>5 About Taskbus</h2><p><strong>Copyright protection and commercial use</strong></p><p>Taskbus itself is an open standard software system that follows the LGPL protocol, but does not specify the license type of the module.</p><p>If you are publishing a commercial module, please complete their own registration certification, activation and other functional design.</p><p>Developed by Goldenhawking Studio, Welcome to join the active developer!</p><p>Email: goldenhawking@163.com</p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
